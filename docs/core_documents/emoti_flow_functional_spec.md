# EmotiFlow - 기능 상세 명세서

## 📋 문서 개요

| 항목 | 내용 |
|------|------|
| **문서명** | EmotiFlow 기능 상세 명세서 |
| **작성일** | 2024년 12월 |
| **버전** | 1.0 |
| **작성자** | AI Assistant |
| **목적** | 각 기능의 상세 동작, 입력/출력, 예외 처리, 설정 옵션 정의 |

---

## 📱 Flutter 앱 페이지 구조

### **메인 네비게이션 (BottomNavigationBar)**
```
🏠 홈 (/) → HomePage
✍️ 일기 (/diary) → DiaryPage  
🤖 AI (/ai) → AIPage
📊 분석 (/analytics) → AnalyticsPage
🎵 음악 (/music) → MusicPage
👤 프로필 (/profile) → ProfilePage
```

### **페이지별 구조**

#### **1. 홈 페이지 (HomePage)**
```
AppBar: 앱 제목, 알림 아이콘, 설정 아이콘
Body: 
  - 오늘의 감정 체크 카드
  - 최근 일기 요약
  - AI 추천 콘텐츠
  - 빠른 일기 작성 버튼
BottomNavigationBar: 메인 네비게이션
```

#### **2. 일기 작성 페이지 (DiaryPage)**
```
AppBar: 뒤로가기, 저장, 공유
Body:
  - 감정 선택 (EmotionSelector)
  - 일기 작성 폼 (DiaryForm)
  - 미디어 첨부 (MediaAttachment)
  - AI 도움말 (AIHelper)
FloatingActionButton: 새 일기 작성
```

#### **3. AI 분석 페이지 (AIPage)**
```
AppBar: 뒤로가기, 설정, 히스토리
Body:
  - 감정 분석 결과 (EmotionAnalysis)
  - AI 조언 카드 (AIAdviceCard)
  - 감정 시각화 (EmotionVisualization)
  - 대화형 인터페이스 (ChatInterface)
```

#### **4. 분석 페이지 (AnalyticsPage)**
```
AppBar: 뒤로가기, 기간 선택, 필터
Body:
  - 감정 통계 차트 (EmotionChart)
  - 달력 뷰 (CalendarView)
  - 트렌드 분석 (TrendAnalysis)
  - 인사이트 요약 (InsightSummary)
```

#### **5. 음악 페이지 (MusicPage)**
```
AppBar: 뒤로가기, 검색, 플레이리스트
Body:
  - 현재 재생 (NowPlaying)
  - 감정별 음악 (EmotionMusic)
  - 플레이리스트 (Playlist)
  - 음악 추천 (MusicRecommendation)
```

#### **6. 프로필 페이지 (ProfilePage)**
```
AppBar: 뒤로가기, 편집, 설정
Body:
  - 프로필 정보 (ProfileInfo)
  - 감정 프로필 (EmotionProfile)
  - 통계 요약 (StatsSummary)
  - 설정 메뉴 (SettingsMenu)
```

### **공통 UI 컴포넌트**
- **AppBar**: 각 페이지 상단의 앱바 (제목, 뒤로가기, 액션 버튼)
- **BottomNavigationBar**: 하단 메인 네비게이션
- **FloatingActionButton**: 주요 액션 버튼
- **Card**: 정보 표시용 카드 컴포넌트
- **Dialog**: 모달 다이얼로그
- **SnackBar**: 간단한 알림 메시지
- **BottomSheet**: 하단에서 올라오는 시트

### **네비게이션 흐름**
```
SplashScreen → Onboarding → Login/Signup → MainApp
                                    ↓
                              HomePage (메인)
                                    ↓
                    ┌─────────┬─────────┬─────────┐
                    ↓         ↓         ↓         ↓
                DiaryPage  AIPage  AnalyticsPage  MusicPage
                    ↓         ↓         ↓         ↓
                DiaryDetail  AIAnalysis  ChartDetail  PlaylistDetail
                    ↓         ↓         ↓         ↓
                SettingsPage ← ProfilePage ← CommunityPage
```

---

## 🔐 사용자 인증 및 프로필 관리

### **기능명: 사용자 인증**
- **기능 ID**: REQ-001
- **설명**: 회원가입, 로그인/로그아웃, 소셜 로그인, 비밀번호 찾기
- **상세 동작**:
  - **회원가입**:
    - 이메일 중복 확인 → 비밀번호 유효성 검증 → 약관 동의 확인 → 계정 생성
    - 이메일 인증 메일 발송 → 인증 완료 시 계정 활성화
  - **로그인**:
    - 이메일/비밀번호 입력 → Firebase Auth 검증 → 로그인 성공/실패 처리
    - 로그인 실패 시 오류 메시지 표시 및 재시도 안내
  - **소셜 로그인**:
    - Google/Apple OAuth 연동 → 사용자 정보 수집 → 기존 계정 연동 또는 신규 계정 생성
  - **비밀번호 찾기**:
    - 이메일 주소 입력 → 재설정 링크 발송 → 링크 클릭 시 새 비밀번호 설정
- **입력**:
  - 이메일, 비밀번호, 닉네임, 약관 동의
- **출력**:
  - 계정 생성/로그인 성공/실패, 인증 메일 발송 완료
- **예외 처리**:
  - 네트워크 오류 시 재시도 버튼 표시
  - 잘못된 이메일 형식 시 유효성 검증 오류 메시지
  - 약관 미동의 시 회원가입 버튼 비활성화
  - **설정 옵션**:
    - 자동 로그인 유지 (계속)
    - 생체 인증 (지문/얼굴인식) 활성화/비활성화
    - 앱 잠금 해제 시 생체 인증 사용

### **기능명: 개인 프로필 설정**
- **기능 ID**: REQ-002
- **설명**: 닉네임, 생년월일, 프로필 이미지 설정
- **상세 동작**:
  - **프로필 정보 수정**:
    - 닉네임 변경 (중복 확인 포함)
    - 생년월일 설정 (나이 제한 없음)
    - 프로필 이미지 업로드/편집/삭제
  - **이미지 처리**:
    - 이미지 크기 자동 조정 (최대 5MB)
    - 원형/사각형 크롭 옵션
    - 필터 및 밝기/대비 조정
- **입력**:
  - 닉네임, 생년월일, 프로필 이미지
- **출력**:
  - 프로필 업데이트 완료, 이미지 업로드 성공
- **예외 처리**:
  - 중복 닉네임 시 오류 메시지
  - 이미지 업로드 실패 시 재시도 안내
  - 네트워크 오류 시 로컬 저장 후 동기화
- **설정 옵션**:
  - 프로필 공개 범위 (전체/친구만/비공개)
  - 이미지 품질 설정 (고/중/저)

### **기능명: 감정 프로필 설정**
- **기능 ID**: REQ-003
- **설명**: 개인 감정 선호도 및 패턴 설정
- **상세 동작**:
  - **감정 선호도 설정**:
    - 주요 감정 3-5개 선택
    - 각 감정별 중요도 레벨 설정 (1-5)
    - 감정 표현 방식 선호도 (텍스트/이미지/음악)
  - **감정 패턴 분석**:
    - 주간/월간 감정 변화 추이
    - 특정 상황별 감정 반응 패턴
    - 개선하고 싶은 감정 영역 설정
- **입력**:
  - 감정 선택, 중요도 레벨, 표현 방식 선호도
- **출력**:
  - 감정 프로필 저장 완료, 패턴 분석 결과
- **예외 처리**:
  - 감정 선택 미완료 시 기본값 적용
  - 패턴 분석 실패 시 재시도 안내
- **설정 옵션**:
  - 감정 프로필 업데이트 주기 (주간/월간)
  - AI 감정 분석 정확도 개선을 위한 데이터 공유 동의

### **기능명: 약관 및 동의 관리**
- **기능 ID**: REQ-004
- **설명**: 이용약관, 개인정보처리방침 동의, 마케팅 수신 동의
- **상세 동작**:
  - **약관 동의**:
    - 회원가입 시 필수 약관 동의 (이용약관, 개인정보처리방침)
    - 선택 약관 동의 (마케팅 수신, 제3자 정보 제공)
    - 약관 내용 상세 보기 및 동의 철회 가능
  - **동의 관리**:
    - 설정에서 언제든지 동의 상태 변경 가능
    - 약관 변경 시 재동의 요청 및 알림
    - 동의 철회 시 영향도 안내
  - **마케팅 수신**:
    - 푸시 알림, 이메일, SMS 수신 동의 개별 관리
    - 수신 거부 시에도 필수 서비스는 정상 이용 가능
- **입력**:
  - 약관 동의 체크박스, 마케팅 수신 설정
- **출력**:
  - 동의 완료, 약관 변경 알림, 동의 상태 확인
- **예외 처리**:
  - 필수 약관 미동의 시 회원가입 진행 불가
  - 약관 변경 시 기존 동의 상태 유지
  - 동의 철회 시 즉시 적용
- **설정 옵션**:
  - 약관 변경 알림 수신 여부
  - 마케팅 수신 유형별 개별 설정

### **기능명: 계정 및 데이터 관리**
- **기능 ID**: REQ-005
- **설명**: 계정 삭제(탈퇴), 데이터 영구 삭제, 데이터 보존 정책
- **상세 동작**:
  - **계정 탈퇴**:
    - 탈퇴 사유 선택 → 최종 확인 → 계정 및 데이터 삭제
    - 탈퇴 후 30일간 복구 가능 (데이터는 즉시 삭제)
    - 탈퇴 완료 시 확인 이메일 발송
  - **데이터 삭제**:
    - 개별 데이터 선택적 삭제
    - 전체 데이터 일괄 삭제
    - 삭제 진행률 표시 및 완료 확인
  - **데이터 보존 정책**:
    - 비활성 계정 1년 후 자동 삭제
    - 로그 데이터 6개월 보존 후 자동 삭제
    - 사용자 설정에 따른 보존 기간 조정
- **입력**:
  - 탈퇴 사유, 삭제할 데이터 선택, 보존 기간 설정
- **출력**:
  - 탈퇴 완료, 데이터 삭제 완료, 보존 정책 적용
- **예외 처리**:
  - 탈퇴 진행 중 오류 시 롤백 및 재시도
  - 대용량 데이터 삭제 시 시간 소요 안내
  - 복구 기간 내 복구 요청 시 즉시 처리
- **설정 옵션**:
  - 데이터 보존 기간 (3개월/6개월/1년/무제한)
  - 자동 삭제 알림 설정

### **기능명: 보안 및 개인정보**
- **기능 ID**: REQ-023
- **설명**: 생체 인증, 앱 잠금, 민감 데이터 암호화, 개인정보 관리
- **상세 동작**:
  - **생체 인증**:
    - 지문/얼굴인식 기반 앱 잠금 해제
    - 생체 인증 실패 시 대체 방법 제공
    - 보안 수준별 인증 방식 선택
  - **앱 잠금**:
    - PIN, 패턴, 비밀번호 설정
    - 자동 잠금 시간 설정
    - 특정 기능별 개별 잠금 설정
  - **데이터 암호화**:
    - 민감한 개인정보 암호화 저장
    - 전송 데이터 SSL/TLS 암호화
    - 로컬 데이터베이스 암호화
- **입력**:
  - 생체 정보, 잠금 설정, 암호화 옵션
- **출력**:
  - 인증 성공/실패, 잠금 상태, 보안 레벨
- **예외 처리**:
  - 생체 인증 실패 시 대체 인증 방법 제공
  - 암호화 오류 시 데이터 보호 모드 활성화
  - 보안 위반 감지 시 즉시 알림
- **설정 옵션**:
  - 생체 인증 민감도 조절
  - 잠금 해제 시도 횟수 제한
  - 자동 로그아웃 시간 설정

---

## ✍️ AI 기반의 일기 작성 및 피드백 기능

### **기능명: AI 대화형 일기**
- **기능 ID**: REQ-006
- **설명**: AI와 대화하며 일기를 작성하는 기능. 감정 키워드 기반 질문으로 깊이 있는 글쓰기 유도
- **상세 동작**:
  - **AI 질문 생성**:
    - 사용자 감정 키워드 기반 맞춤형 질문 생성
    - 이전 응답을 바탕으로 다음 질문 조정
    - 감정 강도에 따른 질문 깊이 조절
  - **대화 인터페이스**:
    - 채팅 형태의 UI로 자연스러운 대화 경험
    - 사용자 응답에 대한 AI 즉시 피드백
    - 대화 히스토리 저장 및 복원
  - **일기 완성**:
    - AI가 사용자 응답을 종합하여 일기 텍스트 생성
    - 감정 분석 및 키워드 추출
    - 일기 제목 자동 생성
- **입력**:
  - 사용자 응답 텍스트, 감정 선택, 날짜
- **출력**:
  - AI 질문, 완성된 일기, 감정 분석 결과
- **예외 처리**:
  - AI 응답 지연 시 로딩 인디케이터 표시
  - 네트워크 오류 시 오프라인 모드로 전환
  - 부적절한 응답 감지 시 재질문
- **설정 옵션**:
  - AI 질문 스타일 (친근한/전문적인/격려하는)
  - 질문 개수 조절 (5-15개)
  - 자동 저장 간격 (30초/1분/2분)

### **기능명: 자유형 일기**
- **기능 ID**: REQ-007
- **설명**: 감정 아이콘, 텍스트, 사진 등을 자유롭게 조합하여 일기 작성
- **상세 동작**:
  - **텍스트 편집**:
    - 리치 텍스트 에디터로 서식 지원 (굵게, 기울임, 밑줄)
    - 자동 저장 및 복구 기능
    - 글자수 카운터 및 제한 (최대 10,000자)
  - **미디어 첨부**:
    - 사진: 갤러리/카메라, 최대 5장, 이미지 압축
    - 그림: 자유 그리기, 감정별 색상 팔레트
    - 음성: 음성 메모 녹음, 최대 3분
  - **감정 표현**:
    - 8가지 감정 카테고리 (기쁨, 슬픔, 분노, 평온, 설렘, 걱정, 감사, 지루함)
    - 감정 강도 1-10점 설정
    - 복합 감정 선택 가능 (최대 3개)
- **입력**:
  - 텍스트, 감정 선택, 미디어 파일, 날짜
- **출력**:
  - 저장된 일기, 미리보기, 자동 저장 상태
- **예외 처리**:
  - 저장 실패 시 자동 백업 및 복구
  - 미디어 파일 크기 초과 시 압축 안내
  - 네트워크 연결 없을 시 로컬 저장 후 동기화
- **설정 옵션**:
  - 자동 저장 간격 (30초/1분/2분)
  - 이미지 품질 설정 (고/중/저)
  - 음성 녹음 품질 설정

### **기능명: AI 감정 시각화**
- **기능 ID**: REQ-008
- **설명**: 일기 내용을 바탕으로 AI가 추상적인 '감정 이미지' 생성
- **상세 동작**:
  - **감정 분석**:
    - 일기 텍스트의 감정 키워드 추출
    - 감정 강도 및 복합 감정 분석
    - 문맥적 감정 변화 패턴 파악
  - **이미지 생성**:
    - OpenAI DALL-E API를 활용한 추상적 감정 이미지 생성
    - 감정별 색상 팔레트 적용
    - 일기 내용과 연관된 시각적 요소 포함
  - **이미지 관리**:
    - 생성된 이미지 저장 및 편집
    - 감정별 이미지 갤러리 구성
    - 이미지 공유 및 내보내기
- **입력**:
  - 일기 텍스트, 감정 선택, 이미지 스타일 설정
- **출력**:
  - AI 생성 감정 이미지, 감정 분석 결과
- **예외 처리**:
  - AI 이미지 생성 실패 시 기본 감정 아이콘 제공
  - 부적절한 이미지 생성 시 필터링 및 재생성
  - API 제한 초과 시 대기열 시스템 적용
- **설정 옵션**:
  - 이미지 생성 스타일 (추상적/구체적/예술적)
  - 이미지 품질 설정 (고/중/저)
  - 자동 이미지 생성 여부

### **기능명: 일기 분석 및 위로**
- **기능 ID**: REQ-009
- **설명**: AI가 일기 내용을 분석하고 따뜻한 위로, 자기 성찰 질문, 해결 방안 제공
- **상세 동작**:
  - **감정 분석**:
    - 일기 텍스트의 감정 상태 분석
    - 감정 변화 패턴 및 트리거 식별
    - 스트레스 레벨 및 대처 능력 평가
  - **맞춤형 피드백**:
    - 감정 상태에 따른 위로 메시지 생성
    - 자기 성찰을 위한 질문 제시
    - 구체적인 해결 방안 및 조언 제공
  - **진행 상황 추적**:
    - 감정 개선 정도 모니터링
    - 목표 달성률 및 성장 기록
    - 정기적인 진전 리포트 생성
- **입력**:
  - 일기 내용, 감정 선택, 개인 목표 설정
- **출력**:
  - AI 분석 결과, 위로 메시지, 성찰 질문, 해결 방안
- **예외 처리**:
  - 부적절한 내용 감지 시 전문가 상담 권장
  - 위기 상황 감지 시 긴급 연락처 및 도움말 제공
  - AI 분석 한계 시 인간 전문가 연계 안내
- **설정 옵션**:
  - 피드백 스타일 (따뜻한/전문적인/격려하는)
  - 분석 깊이 (기본/상세/전문)
  - 위기 상황 감지 민감도 조절

### **기능명: 일기 관리**
- **기능 ID**: REQ-010
- **설명**: 일기 편집, 삭제, 목록 보기, 검색/필터링
- **상세 동작**:
  - **일기 목록**:
    - 날짜별, 감정별, 키워드별 정렬
    - 미리보기 및 썸네일 표시
    - 일기 통계 및 요약 정보
  - **검색 및 필터링**:
    - 텍스트 내용 검색
    - 감정, 날짜, 태그별 필터링
    - 고급 검색 옵션 (복합 조건)
  - **편집 및 삭제**:
    - 일기 내용 수정 및 업데이트
    - 미디어 파일 추가/제거
    - 일기 삭제 및 복구
- **입력**:
  - 검색어, 필터 조건, 편집 내용
- **출력**:
  - 검색 결과, 필터링된 목록, 편집 완료
- **예외 처리**:
  - 검색 결과 없음 시 유사한 일기 추천
  - 편집 충돌 시 버전 관리 및 병합
  - 삭제 실패 시 안전 삭제 모드 적용
- **설정 옵션**:
  - 목록 표시 방식 (카드/리스트/그리드)
  - 검색 히스토리 저장 여부
  - 자동 백업 및 동기화 설정

---

## 🎵 감정 기반의 콘텐츠 기능

### **기능명: 치유 BGM 자동 재생**
- **기능 ID**: REQ-011
- **설명**: 선택한 감정에 따라 저작권 없는 음원 즉시 재생
- **상세 동작**:
  - **감정별 음악 매칭**:
    - 8가지 감정에 맞는 음악 라이브러리 구축
    - 감정 강도에 따른 음악 템포 조절
    - 사용자 선호도 학습 및 맞춤 추천
  - **자동 재생**:
    - 감정 선택 시 즉시 해당 음악 재생
    - 일기 작성 중 배경음악으로 재생
    - 음악과 일기 내용의 감정 일치도 확인
  - **음악 관리**:
    - 즐겨찾기 기능
    - 재생 목록 생성 및 관리
    - 음악 검색 및 필터링
- **입력**:
  - 감정 선택, 음악 설정, 볼륨 조절
- **출력**:
  - 음악 재생, 재생 목록, 즐겨찾기
- **예외 처리**:
  - 음악 로딩 실패 시 대체 음악 제공
  - 네트워크 오류 시 로컬 음악 재생
  - 저작권 문제 시 무료 음원으로 대체
- **설정 옵션**:
  - 자동 재생 여부
  - 볼륨 레벨 (0-100%)
  - 재생 모드 (반복/랜덤/순차)

### **기능명: 긍정 카드 추천**
- **기능 ID**: REQ-012
- **설명**: AI가 3가지 '오늘의 긍정 카드' 추천하여 목표 설정
- **상세 동작**:
  - **카드 생성**:
    - 사용자 감정 상태 및 패턴 분석
    - 개인 성장 목표 및 관심사 반영
    - 계절, 날씨, 요일 등 외부 요소 고려
  - **카드 내용**:
    - 긍정적 마인드셋 제안
    - 구체적인 행동 목표 설정
    - 자기 격려 및 동기부여 메시지
  - **카드 관리**:
    - 카드 저장 및 즐겨찾기
    - 목표 달성률 추적
    - 카드 히스토리 및 통계
- **입력**:
  - 현재 감정 상태, 개인 목표, 선호도
- **출력**:
  - 3가지 긍정 카드, 목표 설정 가이드
- **예외 처리**:
  - 카드 생성 실패 시 기본 카드 제공
  - 부적절한 내용 감지 시 재생성
  - 사용자 피드백 반영 및 개선
- **설정 옵션**:
  - 카드 생성 빈도 (매일/2-3일/주간)
  - 카드 스타일 (격려/도전/평온)
  - 목표 난이도 조절

### **기능명: 감정 패턴 챌린지**
- **기능 ID**: REQ-013
- **설명**: AI가 감정 통계를 분석하여 맞춤형 챌린지 제안
- **상세 동작**:
  - **패턴 분석**:
    - 감정 변화 트렌드 및 패턴 식별
    - 스트레스 트리거 및 대처 방식 분석
    - 개선 가능한 감정 영역 도출
  - **챌린지 설계**:
    - 개인 맞춤형 감정 관리 챌린지 생성
    - 단계별 목표 및 성취 기준 설정
    - 보상 시스템 및 동기부여 요소 포함
  - **진행 관리**:
    - 일일 챌린지 체크리스트 제공
    - 진행률 및 성취도 시각화
    - 챌린지 완료 시 축하 및 다음 단계 안내
- **입력**:
  - 감정 데이터, 개인 목표, 챌린지 선호도
- **출력**:
  - 맞춤형 챌린지, 진행 상황, 성취 인증
- **예외 처리**:
  - 챌린지 난이도 조절 요청 시 즉시 반영
  - 중단 시 재시작 가이드 제공
  - 목표 달성 실패 시 대안 제시
- **설정 옵션**:
  - 챌린지 난이도 (초급/중급/고급)
  - 챌린지 기간 (1주/2주/1개월)
  - 알림 빈도 및 방식

### **기능명: 그림 그리기**
- **기능 ID**: REQ-014
- **설명**: 감정 표현을 위한 그림 그리기 기능
- **상세 동작**:
  - **그림 도구**:
    - 다양한 브러시 및 색상 팔레트
    - 감정별 색상 추천 및 조합
    - 레이어 시스템 및 편집 기능
  - **감정 표현 가이드**:
    - 감정 상태에 따른 그림 스타일 제안
    - 색상 심리학 기반 색상 조합 추천
    - 그림 완성 후 감정 분석 결과 제공
  - **작품 관리**:
    - 그림 저장 및 갤러리 구성
    - 감정별 작품 분류 및 태깅
    - 작품 공유 및 내보내기
- **입력**:
  - 터치/스타일러스 입력, 색상 선택, 도구 설정
- **출력**:
  - 완성된 그림, 감정 분석 결과, 작품 갤러리
- **예외 처리**:
  - 저장 실패 시 자동 백업 및 복구
  - 부적절한 내용 감지 시 필터링
  - 메모리 부족 시 이미지 품질 자동 조정
- **설정 옵션**:
  - 캔버스 크기 및 해상도
  - 자동 저장 간격 및 품질
  - 감정 분석 민감도 조절

---

## 📊 데이터 시각화 및 커뮤니티 기능

### **기능명: 감정 통계 분석**
- **기능 ID**: REQ-015
- **설명**: 주간, 월간, 연간 감정 변화를 그래프와 달력으로 시각화
- **상세 동작**:
  - **데이터 집계**:
    - 기간별 감정 데이터 수집 및 정리
    - 감정 강도 및 복합 감정 분석
    - 패턴 및 트렌드 식별
  - **차트 생성**:
    - 선 그래프: 감정 변화 추이
    - 파이 차트: 감정 분포
    - 막대 그래프: 감정별 빈도
    - 히트맵: 시간대별 감정 패턴
  - **인사이트 제공**:
    - 감정 패턴 분석 결과
    - 개선 제안 및 팁
    - 성장 추이 및 목표 달성률
- **입력**:
  - 선택된 기간, 감정 데이터, 분석 옵션
- **출력**:
  - 인터랙티브 차트, 통계 요약, 인사이트
- **예외 처리**:
  - 데이터 부족 시 안내 메시지 표시
  - 차트 렌더링 실패 시 기본 통계 제공
  - 네트워크 오류 시 로컬 데이터로 분석
- **설정 옵션**:
  - 차트 타입 선택
  - 데이터 표시 기간
  - 인사이트 상세도

### **기능명: 기록 영상화**
- **기능 ID**: REQ-016
- **설명**: 한 달 일기들을 모아 감정 패턴에 어울리는 음악과 함께 영상 제작
- **상세 동작**:
  - **영상 구성**:
    - 월간 일기 요약 및 감정 변화 추이
    - 감정별 색상 테마 및 시각적 효과
    - AI 생성 감정 이미지 및 사용자 그림 포함
  - **음악 매칭**:
    - 감정 패턴에 맞는 배경음악 자동 선택
    - 음악과 영상의 리듬 동기화
    - 사용자 선호도 반영
  - **영상 편집**:
    - 자동 전환 효과 및 애니메이션
    - 텍스트 오버레이 및 자막 생성
    - 영상 길이 및 품질 조절
- **입력**:
  - 월간 일기 데이터, 음악 선호도, 편집 옵션
- **출력**:
  - 완성된 영상, 공유 링크, 다운로드 파일
- **예외 처리**:
  - 영상 생성 실패 시 이미지 슬라이드쇼 제공
  - 음악 저작권 문제 시 무료 음원으로 대체
  - 대용량 파일 처리 시 진행률 표시
- **설정 옵션**:
  - 영상 품질 (720p/1080p/4K)
  - 영상 길이 (30초/1분/2분)
  - 자동 생성 주기 (월간/분기/연간)

### **기능명: 고민 공유 커뮤니티**
- **기능 ID**: REQ-017
- **설명**: 익명성을 보장하며 비슷한 감정을 느낀 사람들과 소통
- **상세 동작**:
  - **게시글 작성**:
    - 익명 게시글 작성 및 감정 태깅
    - 감정 상태 및 고민 내용 공유
    - 사진, 그림 등 미디어 첨부 가능
  - **소통 및 지원**:
    - 댓글 및 답글을 통한 상호 지원
    - 공감 버튼 및 하트 기능
    - 비슷한 경험 공유 및 조언
  - **커뮤니티 관리**:
    - 감정별 게시판 분류
    - 인기 게시글 및 트렌딩 토픽
    - 사용자 활동 및 기여도 추적
- **입력**:
  - 게시글 내용, 감정 태그, 미디어 파일
- **출력**:
  - 게시글 목록, 댓글, 공감 수
- **예외 처리**:
  - 부적절한 내용 감지 시 자동 숨김
  - 신고된 게시글 검토 및 조치
  - 네트워크 오류 시 로컬 저장 후 동기화
- **설정 옵션**:
  - 익명성 수준 (완전 익명/부분 공개)
  - 알림 설정 (댓글/공감/답글)
  - 개인정보 노출 범위

### **기능명: 감정 위기 대처 도구**
- **기능 ID**: REQ-018
- **설명**: 긴급 상황 시 대처 방법 및 연락처 제공
- **상세 동작**:
  - **위기 감지**:
    - 일기 내용의 위험 신호 자동 감지
    - 감정 강도 임계값 초과 시 경고
    - 사용자 상태 체크 및 확인
  - **대처 가이드**:
    - 즉시 실행 가능한 대처 방법 제시
    - 호흡법, 명상, 긴장 이완 기법
    - 단계별 위기 대응 매뉴얼
  - **긴급 연락처**:
    - 전문 상담사 연락처
    - 정신건강 전문기관 정보
    - 24시간 상담 서비스 안내
- **입력**:
  - 일기 내용, 감정 상태, 위기 수준
- **출력**:
  - 위기 대처 가이드, 연락처 정보, 안전 확인
- **예외 처리**:
  - 위기 상황 감지 시 즉시 알림
  - 자동으로 긴급 연락처 표시
  - 사용자 응답 없을 시 추가 확인
- **설정 옵션**:
  - 위기 감지 민감도 조절
  - 자동 알림 설정
  - 신뢰할 수 있는 연락처 등록

### **기능명: 커뮤니티 안전 관리**
- **기능 ID**: REQ-019
- **설명**: 신고/차단/키워드 필터링, 관리자 모더레이션, 가이드라인
- **상세 동작**:
  - **신고 시스템**:
    - 부적절한 글/댓글 신고 기능
    - 신고 사유 선택 및 상세 설명
    - 신고 처리 상태 추적
  - **차단 기능**:
    - 사용자 차단 및 차단 해제
    - 차단된 사용자 글 숨김 처리
    - 차단 목록 관리
  - **키워드 필터링**:
    - 부적절한 키워드 자동 감지
    - 민감한 내용 자동 숨김
    - 필터링 강도 조절
  - **모더레이션**:
    - 관리자 권한으로 글/댓글 관리
    - 신고된 내용 검토 및 처리
    - 커뮤니티 가이드라인 적용
- **입력**:
  - 신고 사유, 차단 대상, 필터링 설정
- **출력**:
  - 신고 처리 결과, 차단 상태, 필터링 적용
- **예외 처리**:
  - 신고 실패 시 재시도 안내
  - 차단 해제 시 즉시 적용
  - 필터링 오류 시 기본 설정 적용
- **설정 옵션**:
  - 필터링 강도 (약함/보통/강함)
  - 신고 알림 수신 여부
  - 자동 차단 조건 설정

---

## ⚙️ 개인화 및 설정 기능

### **기능명: 테마 및 UI 설정**
- **기능 ID**: REQ-020
- **설명**: 다크/라이트 테마, 앱 아이콘 및 색상 커스터마이징
- **상세 동작**:
  - **테마 변경**:
    - 다크/라이트/자동 테마 선택
    - 시스템 설정 연동
    - 테마별 색상 팔레트 적용
  - **색상 커스터마이징**:
    - 주요 색상 변경 (프라이머리, 세컨더리)
    - 감정별 색상 조정
    - 접근성을 고려한 색상 대비 설정
  - **UI 요소 조정**:
    - 폰트 크기 및 스타일 변경
    - 아이콘 크기 조정
    - 애니메이션 효과 설정
- **입력**:
  - 테마 선택, 색상 값, UI 설정
- **출력**:
  - 테마 적용 결과, 색상 미리보기
- **예외 처리**:
  - 색상 대비 부족 시 경고 메시지
  - 테마 적용 실패 시 기본 테마로 복원
  - 설정 저장 실패 시 로컬 백업
- **설정 옵션**:
  - 자동 테마 전환 시간
  - 색상 대비 강화 옵션
  - 애니메이션 속도 조절

### **기능명: 알림 및 리마인더**
- **기능 ID**: REQ-021
- **설명**: 일기 작성 리마인더, AI 조언, 목표 달성 알림, 딥링크 지원
- **상세 동작**:
  - **일기 작성 리마인더**:
    - 사용자 설정 시간에 일기 작성 알림
    - 감정 상태 체크 리마인더
    - 주간/월간 감정 리뷰 알림
  - **AI 조언 알림**:
    - 감정 패턴 변화 감지 시 조언 제공
    - 목표 달성 시 축하 메시지
    - 위기 상황 감지 시 긴급 알림
  - **딥링크 지원**:
    - 알림 클릭 시 해당 페이지로 직접 이동
    - 특정 일기나 분석 결과로 연결
    - 외부 앱에서 앱 내 특정 기능으로 이동
- **입력**:
  - 알림 시간, 알림 유형, 딥링크 설정
- **출력**:
  - 푸시 알림, 인앱 알림, 이메일 알림
- **예외 처리**:
  - 알림 전송 실패 시 재시도
  - 사용자가 알림을 차단한 경우 대체 방법 사용
  - 딥링크 오류 시 기본 페이지로 이동
- **설정 옵션**:
  - 알림 수신 시간대 설정
  - 알림 유형별 개별 설정
  - 딥링크 활성화/비활성화

### **기능명: 데이터 관리**
- **기능 ID**: REQ-022
- **설명**: 사용자 데이터 백업, 클라우드 동기화, CSV/JSON 내보내기/가져오기
- **상세 동작**:
  - **데이터 백업**:
    - 자동 백업 (일간/주간/월간)
    - 수동 백업 및 복원
    - 백업 파일 암호화 및 압축
  - **클라우드 동기화**:
    - Firebase를 통한 실시간 동기화
    - 오프라인 데이터와 온라인 데이터 병합
    - 충돌 해결 및 버전 관리
  - **데이터 내보내기/가져오기**:
    - CSV/JSON 형식으로 데이터 내보내기
    - 다른 앱에서 데이터 가져오기
    - 데이터 마이그레이션 지원
- **입력**:
  - 백업 설정, 동기화 옵션, 내보내기 형식
- **출력**:
  - 백업 파일, 동기화 상태, 내보내기 파일
- **예외 처리**:
  - 백업 실패 시 재시도 및 오류 로그
  - 동기화 충돌 시 사용자 선택 기반 해결
  - 데이터 손실 방지를 위한 안전장치
- **설정 옵션**:
  - 자동 백업 주기 및 시간
  - 동기화 대역폭 제한
  - 백업 파일 보관 기간

---

## 🚀 시스템 및 운영 기능

### **기능명: 오프라인 및 동기화**
- **기능 ID**: REQ-024
- **설명**: 오프라인 일기 작성/조회, 네트워크 복구 시 동기화, 충돌 해결
- **상세 동작**:
  - **오프라인 모드**:
    - 네트워크 연결 없이 일기 작성/편집
    - 로컬 데이터베이스에 임시 저장
    - 오프라인 상태 표시 및 안내
  - **동기화**:
    - 네트워크 복구 시 자동 동기화
    - 로컬 데이터와 클라우드 데이터 비교
    - 충돌 감지 및 해결 방안 제시
  - **충돌 해결**:
    - 최신 수정 우선 규칙
    - 사용자 선택 병합 옵션
    - 충돌 이력 관리 및 복구
- **입력**:
  - 오프라인 작성 내용, 동기화 설정, 충돌 해결 선택
- **출력**:
  - 동기화 완료, 충돌 해결 결과, 오프라인 상태
- **예외 처리**:
  - 동기화 실패 시 재시도 및 오류 안내
  - 충돌 해결 실패 시 백업 데이터 복원
  - 저장 공간 부족 시 정리 안내
- **설정 옵션**:
  - 자동 동기화 여부
  - 동기화 주기 설정
  - 충돌 해결 규칙 선택

### **기능명: AI 운영 및 모니터링**
- **기능 ID**: REQ-025
- **설명**: AI 요청 타임아웃/재시도/폴백, 사용량 제한, 비용 모니터링
- **상세 동작**:
  - **요청 관리**:
    - API 요청 타임아웃 설정 (30초/60초/120초)
    - 실패 시 자동 재시도 (최대 3회)
    - 폴백 모델로 대체 응답 제공
  - **사용량 제한**:
    - 일일 AI 요청 수 제한 (무료: 50회, 프리미엄: 500회)
    - 월간 사용량 통계 및 알림
    - 제한 도달 시 대체 기능 안내
  - **비용 모니터링**:
    - API 호출 비용 실시간 추적
    - 예산 설정 및 초과 알림
    - 비용 최적화 제안
- **입력**:
  - 타임아웃 설정, 사용량 제한, 예산 설정
- **출력**:
  - 사용량 통계, 비용 리포트, 최적화 제안
- **예외 처리**:
  - API 오류 시 폴백 모델로 전환
  - 사용량 초과 시 기능 제한 안내
  - 비용 초과 시 사용 중단 및 알림
- **설정 옵션**:
  - 타임아웃 시간 조절
  - 사용량 제한 알림 설정
  - 비용 모니터링 주기

### **기능명: 성능 및 안정성**
- **기능 ID**: REQ-026
- **설명**: 크래시 리포팅, 성능 모니터링, 이미지/영상 압축, 캐싱
- **상세 동작**:
  - **크래시 리포팅**:
    - Firebase Crashlytics 연동
    - 크래시 로그 자동 수집 및 전송
    - 크래시 패턴 분석 및 해결 방안
  - **성능 모니터링**:
    - 앱 시작 시간, 화면 전환 속도 측정
    - 메모리 사용량 및 배터리 소모량 추적
    - 성능 병목 지점 식별
  - **미디어 최적화**:
    - 이미지 자동 압축 및 리사이징
    - 영상 품질 조절 및 스트리밍 최적화
    - 캐싱 전략으로 로딩 속도 향상
- **입력**:
  - 성능 설정, 압축 품질, 캐싱 정책
- **출력**:
  - 성능 리포트, 크래시 통계, 최적화 제안
- **예외 처리**:
  - 크래시 리포팅 실패 시 로컬 저장
  - 성능 측정 오류 시 기본 값 사용
  - 미디어 처리 실패 시 원본 파일 제공
- **설정 옵션**:
  - 크래시 리포팅 수집 여부
  - 성능 모니터링 상세도
  - 미디어 압축 품질

### **기능명: 접근성 및 국제화**
- **기능 ID**: REQ-027
- **설명**: 접근성 지원, 다국어 지원, 색상 대비, 폰트 스케일
- **상세 동작**:
  - **접근성 지원**:
    - 스크린 리더 호환성 (Semantics API)
    - 색상 대비 최소 4.5:1 유지
    - 터치 영역 최소 44x44px 보장
    - 폰트 크기 동적 조절 (시스템 설정 연동)
  - **다국어 지원**:
    - 한국어 기본 지원
    - 영어 확장 지원 (추후)
    - 언어별 UI 레이아웃 최적화
    - 날짜/시간 형식 지역화
  - **사용자 맞춤**:
    - 고대비 모드 지원
    - 애니메이션 감소 옵션
    - 음성 안내 설정
    - 키보드 네비게이션 지원
- **입력**:
  - 접근성 설정, 언어 선택, 사용자 맞춤 옵션
- **출력**:
  - 접근성 적용 결과, 다국어 UI, 맞춤 설정
- **예외 처리**:
  - 접근성 기능 미지원 시 대체 방법 제공
  - 언어 파일 누락 시 기본 언어로 표시
  - 맞춤 설정 실패 시 기본값 적용
- **설정 옵션**:
  - 접근성 기능 활성화/비활성화
  - 언어 우선순위 설정
  - 사용자 맞춤 수준 조절

### **기능명: 반응형 UI 및 멀티 디바이스**
- **기능 ID**: REQ-028
- **설명**: 태블릿, 폴드, 데스크톱 등 다양한 화면 크기에서의 UI 최적화
- **상세 동작**:
  - **반응형 레이아웃**:
    - 화면 크기별 자동 레이아웃 조정
    - 모바일: 1단 레이아웃, 세로 스크롤
    - 태블릿: 2단 레이아웃, 가로/세로 혼합
    - 데스크톱: 3단 레이아웃, 사이드바 포함
  - **적응형 컴포넌트**:
    - 화면 크기에 따른 컴포넌트 크기 조정
    - 터치/마우스 입력 방식 자동 전환
    - 키보드 단축키 및 네비게이션 지원
  - **화면 방향 대응**:
    - 세로/가로 모드 자동 전환
    - 폴드 디바이스 화면 분할 대응
    - 멀티 윈도우 모드 지원
  - **디바이스별 최적화**:
    - 태블릿: 더 큰 터치 영역, 상세 정보 표시
    - 폴드: 화면 분할 시 레이아웃 조정
    - 데스크톱: 마우스 호버 효과, 키보드 단축키
- **입력**:
  - 화면 크기, 방향, 디바이스 타입, 사용자 설정
- **출력**:
  - 최적화된 레이아웃, 적응형 컴포넌트, 반응형 UI
- **예외 처리**:
  - 지원하지 않는 화면 크기 시 기본 레이아웃 적용
  - 레이아웃 전환 실패 시 이전 상태 유지
  - 디바이스별 기능 미지원 시 대체 방법 제공
- **설정 옵션**:
  - 레이아웃 모드 수동 선택
  - 컴포넌트 크기 조절
  - 화면 방향 고정/자동 전환
  - 디바이스별 최적화 수준 조절

---

## 📱 기술 요구사항

> **참고**: 기술 요구사항 상세 내용은 `emoti_flow_tech_summary.md` 문서를 참조하세요.
> 
> - **TECH-001**: Flutter 앱 개발
> - **TECH-002**: Firebase 연동
> - **TECH-003**: OpenAI API 연동
> - **TECH-004**: 차트 및 데이터 시각화
> - **TECH-005**: 그림 그리기 기능
> - **TECH-006**: 음원 재생
> - **TECH-007**: 이미지 생성
> - **TECH-008**: 영상 제작
> - **TECH-009**: 로컬 저장소
> - **TECH-010**: HTTP 통신
> - **TECH-011**: 보안 및 암호화
> - **TECH-012**: 오프라인 지원
> - **TECH-013**: 성능 모니터링
> - **TECH-014**: 접근성
> - **TECH-015**: 반응형 UI
> - **TECH-016**: 멀티 디바이스

---

## 📋 문서 정보

### **문서 버전 관리**
| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 1.0 | 2024년 12월 | 초기 작성 | AI Assistant |
| 1.1 | 2024년 12월 | 누락 기능 추가 및 일관성 개선 | AI Assistant |

### **검토 및 승인**
| 단계 | 담당자 | 날짜 | 상태 |
|------|--------|------|------|
| 작성 | AI Assistant | 2024년 12월 | 완료 |
| 검토 | - | - | 대기 |
| 승인 | - | - | 대기 |

### **참고 문서**
- `emoti_flow_requirements.md`: 프로젝트 요구사항 정의서
- `emoti_flow_ia.md`: 정보 아키텍처 문서
- `emoti_flow_page_definition.md`: 페이지 정의서
- `emoti_flow_uiux_guide.md`: UI/UX 상세 가이드
- `emoti_flow_tech_summary.md`: 기술적 요약 및 기술 요구사항

---

## 🔄 변경 이력

### **v1.1 (2024년 12월)**
- **추가된 기능**:
  - 개인 프로필 설정 (REQ-002)
  - 감정 프로필 설정 (REQ-003)
  - AI 감정 시각화 (REQ-008)
  - 일기 분석 및 위로 (REQ-009)
  - 일기 관리 (REQ-010)
  - 긍정 카드 추천 (REQ-012)
  - 감정 패턴 챌린지 (REQ-013)
  - 그림 그리기 (REQ-014)
  - 기록 영상화 (REQ-016)
  - 고민 공유 커뮤니티 (REQ-017)
  - 감정 위기 대처 도구 (REQ-018)
  - 알림 및 리마인더 (REQ-021)
  - 데이터 관리 (REQ-022)
  - 보안 및 개인정보 (REQ-023)
  - 시스템 및 운영 기능 전체 (REQ-024 ~ REQ-028)
  - 기술 요구사항 전체 (TECH-001 ~ TECH-016) → `emoti_flow_tech_summary.md`로 이동

- **개선된 내용**:
  - requirements 문서와의 일관성 확보
  - 기능 ID 체계 정리
  - 상세 동작 및 예외 처리 보완
  - 설정 옵션 상세화

- **수정된 내용**:
  - AI 대화형 일기 설명 명확화
  - 화면 구성 및 사용자 경험 특징 추가

---

## 🛠️ Flutter 앱 구현 세부사항

### **앱 구조 및 아키텍처**

#### **프로젝트 구조**
```
lib/
├── main.dart                    # 앱 진입점
├── app/                        # 앱 설정
│   ├── app.dart               # 메인 앱 위젯
│   ├── theme/                 # 테마 설정
│   └── routes/                # 라우팅 설정
├── features/                   # 기능별 모듈
│   ├── home/                  # 홈 기능
│   ├── diary/                 # 일기 기능
│   ├── ai/                    # AI 기능
│   ├── analytics/             # 분석 기능
│   ├── music/                 # 음악 기능
│   └── profile/               # 프로필 기능
├── shared/                     # 공통 컴포넌트
│   ├── widgets/               # 공통 위젯
│   ├── models/                # 공통 모델
│   ├── services/              # 공통 서비스
│   └── utils/                 # 유틸리티
└── core/                       # 핵심 기능
    ├── constants/              # 상수
    ├── errors/                 # 에러 처리
    └── network/                # 네트워크 처리
```

#### **상태 관리 (Riverpod)**
```dart
// 상태 관리 구조
final authProvider = StateNotifierProvider<AuthNotifier, AuthState>((ref) {
  return AuthNotifier(ref.read(authServiceProvider));
});

final diaryProvider = StateNotifierProvider<DiaryNotifier, DiaryState>((ref) {
  return DiaryNotifier(ref.read(diaryServiceProvider));
});

final aiProvider = StateNotifierProvider<AINotifier, AIState>((ref) {
  return AINotifier(ref.read(aiServiceProvider));
});
```

#### **라우팅 (GoRouter)**
```dart
// 라우팅 설정
final router = GoRouter(
  initialLocation: '/',
  routes: [
    GoRoute(
      path: '/',
      builder: (context, state) => const HomePage(),
    ),
    GoRoute(
      path: '/diary',
      builder: (context, state) => const DiaryPage(),
    ),
    // ... 기타 라우트
  ],
);
```

### **UI 컴포넌트 구현**

#### **AppBar 구현**
```dart
class EmotiAppBar extends StatelessWidget implements PreferredSizeWidget {
  final String title;
  final List<Widget>? actions;
  final bool showBackButton;
  
  @override
  Widget build(BuildContext context) {
    return AppBar(
      title: Text(title),
      leading: showBackButton ? BackButton() : null,
      actions: actions,
      backgroundColor: Theme.of(context).colorScheme.surface,
      elevation: 0,
    );
  }
  
  @override
  Size get preferredSize => Size.fromHeight(kToolbarHeight);
}
```

#### **BottomNavigationBar 구현**
```dart
class EmotiBottomNavigationBar extends StatelessWidget {
  final int currentIndex;
  final ValueChanged<int> onTap;
  
  @override
  Widget build(BuildContext context) {
    return BottomNavigationBar(
      currentIndex: currentIndex,
      onTap: onTap,
      type: BottomNavigationBarType.fixed,
      items: const [
        BottomNavigationBarItem(icon: Icon(Icons.home), label: '홈'),
        BottomNavigationBarItem(icon: Icon(Icons.edit), label: '일기'),
        BottomNavigationBarItem(icon: Icon(Icons.psychology), label: 'AI'),
        BottomNavigationBarItem(icon: Icon(Icons.analytics), label: '분석'),
        BottomNavigationBarItem(icon: Icon(Icons.music_note), label: '음악'),
        BottomNavigationBarItem(icon: Icon(Icons.person), label: '프로필'),
      ],
    );
  }
}
```

> **참고**: 공통 위젯 구현은 `emoti_flow_uiux_guide.md` 문서를 참조하세요.

> **참고**: 데이터 모델 및 서비스 구현, 성능 최적화, 테스트 전략은 `emoti_flow_tech_summary.md` 문서를 참조하세요.
